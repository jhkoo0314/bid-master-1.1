# Bid Master — pointplan.md
경매 시뮬레이션의 **포인트·레벨·랭킹** 규칙을 일관되게 적용하기 위한 기준 문서입니다.  
목표: 학습 효과(지식·전략·리스크관리)를 점수화하여 **재도전 동기**와 **실전 감각**을 강화합니다.

---

## 1) 용어 정의
- **포인트(Point, P)**: 개별 행동/라운드에서 즉시 적립·차감되는 값. 시즌과 무관하게 누적 가능.
- **경험치(XP)**: 레벨 상승에 사용되는 값. 포인트와 1:1 전환(기본)되지만, 일부 보너스는 XP 전용으로 지급될 수 있음.
- **랭크 포인트(RP)**: 시즌 등급 산정용 점수. 매칭·리더보드에 사용. 시즌 종료 시 초기화(또는 소폭 연동).
- **매물 난이도(D)**: 시스템이 산출한 난이도(1.0~3.0). 정보 비대칭·경쟁강도·가격변동성 포함.
- **희소성(S)**: 공급 희소성 계수(1.0~2.0). 동일 카테고리 내 등장 빈도에 따라 변동.
- **경쟁계수(C)**: 해당 라운드의 실참여자 수·유효입찰 수 기반(1.0~2.0).
- **정확도(A)**: 사용자의 평가가치 추정치와 낙찰가/시가 간 오차(0.0~1.0), 1.0에 가까울수록 정확.
- **속도(V)**: 제한 시간 대비 의사결정 속도(0.8~1.2)로 보정.
- **리스크관리(R)**: 예산준수·손절 실행·리스크 노출도 감소 여부(0.8~1.2)로 보정.

---

## 2) 포인트 기본 공식
행동/라운드 종료 시 포인트는 아래로 계산합니다.

**기본식**  
```
P = Base × D × S × C × A × V × R + Bonus − Penalty
```
- **Base**: 행위 타입별 기본점수(표 1 참조).
- **D,S,C**: 난이도·희소성·경쟁 계수(가 multiplicative).
- **A**: 정확도(추정가 오차율 |오차| ≤ 5% → 1.1, 5~15% → 1.0, 15~30% → 0.9, >30% → 0.8).
- **V**: 속도 보정(상위 25% 빠른 결정 1.1, 평균 1.0, 하위 25% 0.9).
- **R**: 리스크 관리(예산 내·손절 적시 1.05~1.1, 과도노출 0.9).
- **Bonus**: 시나리오·연속 성공·학습 미션 등 추가 가점.
- **Penalty**: 규칙 위반·무분별한 과입찰·연속 이탈.

### 표 1. 행위 타입별 Base
| 행위 | 설명 | Base |
|---|---|---:|
| 합리적 낙찰 | 목표수익률 이상·예산준수 낙찰 | 120 |
| 학습적 낙찰 | 목표수익률 미달이나 분석 타당 | 80 |
| 전략적 유찰 | 무리한 경쟁 회피로 유찰 | 40 |
| 예산 보호 손절 | 사전 손절 기준 준수 | 35 |
| 리서치 심화 | 문서·데이터 열람/메모·체크리스트 완수 | 20 |
| 시장가 추정 입력 | 감정가/시가 가설 제출 | 10 |
| 비합리적 낙찰 | 과입찰(벌점 전용) | 0 |

> **과입찰 판정 기준(벌점)**: 예상 손익률 < -5% 이거나 예산 초과 낙찰 시 `Penalty += 60` (재발 시 누진 1.25배).

---

## 3) 난이도·계수 산정
- **D(난이도)**: 시스템이 매물 메타데이터와 사용자 집단 성공률로 산정. 기본 1.0, 상·최상 난도는 1.5/2.0/3.0.
- **S(희소성)**: 동일 카테고리 최근 30라운드 기준 하위 10% 빈도 → 1.8~2.0, 보통 1.0~1.3.
- **C(경쟁)**: 유효입찰자 수 n일 때 `C = min(1 + 0.05×(n-3), 2.0)` (n≤3이면 1.0 고정).

---

## 4) 보너스/패널티 세부
- **연속 성공 보너스(Combo)**: 합리적 낙찰이 연속 k회일 때 `Bonus += 15×k` (상한 60).
- **정밀 분석 보너스**: 체크리스트 100% + 증빙노트 제출 시 +25.
- **신속·정확 보너스**: 상위 10% 속도 & A≥1.0 동시 충족 +20.
- **학습 미션 보너스**: 일일/주간 과제 완료 +30/+80.
- **비매너/규칙 위반**: 의도적 시간끌기, 스나이핑 봇류 사용 적발 시 `Penalty += 150` 및 RP 제재.

---

## 5) 경험치(XP)·레벨
- **획득**: 기본적으로 `1P = 1XP`. 학습 미션은 +25% XP 가중.
- **레벨 범위**: Lv.1 ~ Lv.50.
- **레벨업 요구치**: `XP_req(Lv) = 150 + 25×(Lv-1)^1.35` (소수점 올림).
- **레벨 보상**: 체크리스트 슬롯 해제, 리포트 템플릿 추가, 고난도 매물 접근권, UI 테마 등 **기능형 보상 위주**.
- **레벨 다운 없음**. 시즌과 무관하게 유지.

예시(요구 XP 일부):
| Lv | 누적 필요 XP(대략) |
|---:|---:|
| 5 | ~ 1,000 |
| 10 | ~ 3,000 |
| 20 | ~ 9,000 |
| 30 | ~ 18,500 |
| 40 | ~ 31,000 |
| 50 | ~ 48,000 |

---

## 6) 랭크(Rank)·시즌
- **등급 체계**: Bronze, Silver, Gold, Platinum, Diamond, Master, Grandmaster.
- **초기 배치**: 신규 시즌 시작 시 배치전 5경기로 초기 RP 산출(기본 1,000, 분산 ±200).
- **매칭용 RP 변동**: 라운드 결과에 따라
  ```
  ΔRP = K × (실제 성과지수 − 기대 성과지수)
  ```
  - **성과지수**: 낙찰수익률·정확도·리스크관리 지표를 0~1로 정규화하여 가중합.
  - **K**: 10~40 (상대·난도에 따라 자동 조절).
- **승급/강등**: 티어 내 100RP 단위 세부 디비전(IV→I). 승급전/보호 구간 선택 가능(옵션).
- **시즌 운영**: 4주(28일) 기본. 종료 시
  - 상위 1%: 한정 배지 + 프로필 프레임
  - 상위 10%: 한정 배지
  - 모든 참여자: 시즌 요약 리포트(강점/약점·학습 권장 루트)

---

## 7) 매물 스케일링 규칙
- **수익률 목표치(Target ROI)**: 카테고리별 기본치(예: 아파트 6%, 상가 8%…).  
- **정확도(A)**: `A = clamp(1.2 − 2×|예상시가−실시가|/실시가, 0.8, 1.1)`
- **과열 방지**: 동일 매물군에서 연속 과입찰 발생 시 다음 라운드 `Base` 10% 삭감.

---

## 8) 미션·업적
- **일일 미션**: ①시장가 추정 3건 제출 ②리서치 심화 1건 ③예산 보호 손절 1회 → 완료 시 +30P/+38XP.
- **주간 미션**: ①합리적 낙찰 3회 ②리포트 공유 1회 → +80P/+100XP.
- **업적 예**: 첫 낙찰, 10연속 무과입찰, 정확도 상위 5% 달성 등(영구 배지·소량 P).

---

## 9) 리더보드·타이브레이커
- **기본 정렬**: 시즌 RP → 합리적 낙찰률 → 평균 정확도(A) → 평균 수익률 → 총 포인트.
- **부정행위 탐지**: 비정상 속도 패턴·동일 IP 다계정 매칭·비정상 과입찰 루프는 자동 플래그 및 심사.

---

## 10) 데이터 모델(요약)
- `users(id, level, xp, total_point, current_rp, season_id, flags…)`
- `rounds(id, difficulty, scarcity, competitor_count, target_roi, actual_price, …)`
- `actions(id, user_id, round_id, type, base, a, v, r, bonus, penalty, point)`
- `missions(id, type, period, reward_point, reward_xp)` / `mission_logs(user_id, mission_id, completed_at)`
- `ranks(user_id, season_id, rp, tier, division)`

> 현재는 **프론트 단 로컬 상태**로 시뮬레이션하고, 추후 Supabase 연동 시 동일 스키마를 확장 적용합니다.

---

## 11) UI/이벤트 명세(커서 빌드 기준)
- 이벤트 키:
  - `action:estimate.submit` (시장가 추정 입력)
  - `action:research.complete`
  - `action:bid.win` / `action:bid.lose` / `action:bid.skip_strategic`
  - `action:stoploss.trigger`
  - `mission:daily.complete` / `mission:weekly.complete`
  - `season:placement.finish` / `season:finish`
- 공용 계산 유틸:
  - `calcPoint({ base, D, S, C, A, V, R, bonus, penalty })`
  - `calcAccuracy({ estimate, actual }) → A`
  - `calcRPDelta({ performanceIndex, expectedIndex, K })`

---

## 12) 예시 시나리오
1) **합리적 낙찰**  
- Base 120, D 1.5, S 1.2, C 1.2, A 1.05, V 1.0, R 1.05, Bonus 20, Penalty 0  
- `P ≈ 120×1.5×1.2×1.2×1.05×1.0×1.05 + 20 ≈ 286 + 20 = 306`  
- XP 306, RP는 성과지수에 따라 별도 계산.

2) **전략적 유찰(경쟁 회피)**  
- Base 40, D 1.8, S 1.3, C 1.5, A 1.0, V 1.1, R 1.1, Bonus 10  
- `P ≈ 40×1.8×1.3×1.5×1.0×1.1×1.1 + 10 ≈ 170 + 10 = 180`

3) **과입찰 낙찰(벌점)**  
- Base 0, D 1.6, S 1.1, C 1.3, A 0.9, V 0.9, R 0.9, Bonus 0, Penalty 60  
- `P = 0 − 60 = −60` (누진 시 −75)

---

## 13) 기본 파라미터(초기값)
| 항목 | 값 |
|---|---|
| 정확도 상·중·하 한계 | 5% / 15% / 30% |
| 속도 보정(상/중/하) | 1.1 / 1.0 / 0.9 |
| 리스크 보정(양/중/음) | 1.1 / 1.0 / 0.9 |
| 연속 성공 보너스 상한 | +60 |
| 과입찰 벌점(기본/누진) | 60 / ×1.25 |
| 시즌 길이 | 28일 |
| 초기 RP | 1,000 ± 200 |
| K 범위 | 10 ~ 40 |

---

## 14) 운영 원칙
1. **학습 우선**: 점수는 수익률뿐 아니라 분석·리스크관리를 반영.
2. **투명성**: 사용자에게 가중치·벌점 기준을 명시.
3. **메타 안정성**: 특정 전술 과열 시 패치노트로 Base/계수 조정.
4. **치팅 제로**: 감지·제재 로직을 사전에 공개.

---

## 15) 변경 이력
- v1.0 (2025-10-28, KST): 초기 작성 — 포인트 공식/레벨·랭킹/시즌 규정/계수 표준화.
